<!DOCTYPE html>

<html lang="pt" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>bioinf.alinhamento &#8212; Documentação portefolio_AASB 0.1</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=27fed22d" />
    <script src="../../_static/documentation_options.js?v=6e1fffae"></script>
    <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../_static/translations.js?v=beaedd51"></script>
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Pesquisar" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Código fonte de bioinf.alinhamento</h1><div class="highlight"><pre>
<span></span><span class="c1">#Alinhamento de Sequências</span>

<span class="c1">#Matrizes de Pontos:</span>
<div class="viewcode-block" id="identificar_sequencia">
<a class="viewcode-back" href="../../api.html#bioinf.alinhamento.identificar_sequencia">[documentos]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">identificar_sequencia</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Identifica se a sequência é DNA, RNA ou proteína.</span>

<span class="sd">    Args:</span>
<span class="sd">        seq (str): Sequência biológica.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: &quot;DNA&quot;, &quot;RNA&quot;, &quot;AMINO&quot; ou &quot;ERRO&quot; se não for possível identificar.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; identificar_sequencia(&quot;ACGT&quot;)</span>
<span class="sd">        &#39;DNA&#39;</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">seq</span> <span class="o">=</span> <span class="n">seq</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
  <span class="n">dna</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="s2">&quot;ACTG&quot;</span><span class="p">)</span>
  <span class="n">rna</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="s2">&quot;ACUG&quot;</span><span class="p">)</span>
  <span class="n">proteina</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="s2">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span><span class="p">)</span>

  <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;G&#39;</span><span class="p">}):</span>
      <span class="k">return</span> <span class="s2">&quot;Introduza mais informação da sequência para poder determinar com mais exatidão&quot;</span>
  <span class="k">elif</span> <span class="nb">set</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">dna</span><span class="p">):</span>
      <span class="k">return</span> <span class="s2">&quot;DNA&quot;</span>
  <span class="k">elif</span> <span class="nb">set</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">rna</span><span class="p">):</span>
      <span class="k">return</span> <span class="s2">&quot;RNA&quot;</span>
  <span class="k">elif</span> <span class="nb">set</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">proteina</span><span class="p">):</span>
      <span class="k">return</span> <span class="s2">&quot;AMINO&quot;</span>
  <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="s2">&quot;ERRO&quot;</span></div>


<div class="viewcode-block" id="matriz_de_zeros">
<a class="viewcode-back" href="../../api.html#bioinf.alinhamento.matriz_de_zeros">[documentos]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">matriz_de_zeros</span><span class="p">(</span><span class="n">seq1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">seq2</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Inicia uma matriz de zeros com tamanho len(seq1)+1 x len(seq2)+1.</span>

<span class="sd">    Args:</span>
<span class="sd">        seq1 (str): Primeira sequência.</span>
<span class="sd">        seq2 (str): Segunda sequência.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[list[int]]: Matriz preenchida com zeros.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; matriz_de_zeros(&quot;AC&quot;, &quot;GT&quot;)</span>
<span class="sd">        [[0, 0, 0], [0, 0, 0], [0, 0, 0]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span></div>



<div class="viewcode-block" id="janela_match">
<a class="viewcode-back" href="../../api.html#bioinf.alinhamento.janela_match">[documentos]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">janela_match</span><span class="p">(</span><span class="n">seq1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">seq2</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pos1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">pos2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">window</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compara duas janelas de comprimento `window` nas sequências.</span>

<span class="sd">    Args:</span>
<span class="sd">        seq1 (str): Primeira sequência.</span>
<span class="sd">        seq2 (str): Segunda sequência.</span>
<span class="sd">        pos1 (int): Posição inicial na primeira sequência.</span>
<span class="sd">        pos2 (int): Posição inicial na segunda sequência.</span>
<span class="sd">        window (int): Tamanho da janela a comparar.</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: Número de posições iguais dentro da janela.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; janela_match(&quot;ACGT&quot;, &quot;ACGA&quot;, 0, 0, 3)</span>
<span class="sd">        3</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">iguais</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">window</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">seq1</span><span class="p">[</span><span class="n">pos1</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">seq2</span><span class="p">[</span><span class="n">pos2</span> <span class="o">+</span> <span class="n">i</span><span class="p">]:</span>
            <span class="n">iguais</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">iguais</span></div>



<div class="viewcode-block" id="dot_plot_janela">
<a class="viewcode-back" href="../../api.html#bioinf.alinhamento.dot_plot_janela">[documentos]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">dot_plot_janela</span><span class="p">(</span><span class="n">seq1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">seq2</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">window</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">stringency</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cria dot plot usando janela deslizante e stringency mínima.</span>

<span class="sd">    Args:</span>
<span class="sd">        seq1 (str): Primeira sequência.</span>
<span class="sd">        seq2 (str): Segunda sequência.</span>
<span class="sd">        window (int): Tamanho da janela.</span>
<span class="sd">        stringency (int): Número mínimo de matches na janela.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[list[int]]: Matriz de 0s e 1s indicando matches.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; dot_plot_janela(&quot;ACGT&quot;, &quot;ACGA&quot;, 3, 2)</span>
<span class="sd">        [[1, 0], [0, 0]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">matriz</span> <span class="o">=</span> <span class="n">matriz_de_zeros</span><span class="p">(</span><span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">)</span>
    <span class="n">limite1</span><span class="p">,</span> <span class="n">limite2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq1</span><span class="p">)</span> <span class="o">-</span> <span class="n">window</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq2</span><span class="p">)</span> <span class="o">-</span> <span class="n">window</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">for</span> <span class="n">p1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">limite1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">p2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">limite2</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">janela_match</span><span class="p">(</span><span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">window</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">stringency</span><span class="p">:</span>
                <span class="n">matriz</span><span class="p">[</span><span class="n">p1</span><span class="p">][</span><span class="n">p2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">matriz</span></div>



<div class="viewcode-block" id="imprimir_dot_plot">
<a class="viewcode-back" href="../../api.html#bioinf.alinhamento.imprimir_dot_plot">[documentos]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">imprimir_dot_plot</span><span class="p">(</span><span class="n">seq1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">seq2</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">window</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">stringency</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Imprime um dot plot com sliding window e stringency,</span>
<span class="sd">    mostrando explicitamente as janelas de ambas as</span>
<span class="sd">    sequências nos eixos e alinhando os pontos corretamente.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">matriz</span> <span class="o">=</span> <span class="n">dot_plot_janela</span><span class="p">(</span><span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">stringency</span><span class="p">)</span>

    <span class="n">limite1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq1</span><span class="p">)</span> <span class="o">-</span> <span class="n">window</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">limite2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq2</span><span class="p">)</span> <span class="o">-</span> <span class="n">window</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">janelas1</span> <span class="o">=</span> <span class="p">[</span><span class="n">seq1</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">limite1</span><span class="p">)]</span>
    <span class="n">janelas2</span> <span class="o">=</span> <span class="p">[</span><span class="n">seq2</span><span class="p">[</span><span class="n">j</span><span class="p">:</span><span class="n">j</span> <span class="o">+</span> <span class="n">window</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">limite2</span><span class="p">)]</span>

    <span class="n">col_width</span> <span class="o">=</span> <span class="n">window</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sequência 1: </span><span class="si">{</span><span class="n">seq1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sequência 2: </span><span class="si">{</span><span class="n">seq2</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">header</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="p">(</span><span class="n">col_width</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">janelas2</span><span class="p">:</span>
        <span class="n">header</span> <span class="o">+=</span> <span class="n">j</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="n">col_width</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">janela</span><span class="p">,</span> <span class="n">linha</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">janelas1</span><span class="p">,</span> <span class="n">matriz</span><span class="p">):</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">janela</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="n">col_width</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;  &quot;</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">linha</span><span class="p">:</span>
            <span class="n">row</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;•&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="n">col_width</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="p">(</span><span class="n">col_width</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span></div>



<span class="c1">#Needleman-Wunsch (global) e Smith-Waterman (local):</span>
<span class="c1"># cálculo + reconstrução</span>

<div class="viewcode-block" id="matriz_substituição_proteína">
<a class="viewcode-back" href="../../api.html#bioinf.alinhamento.matriz_substituição_proteína">[documentos]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">matriz_substituição_proteína</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cria a matriz de substituição BLOSUM62 para proteínas.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[tuple[str, str], int]: Matriz de substituição para cada par de aminoácidos.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; subst = matriz_substituição_proteína()</span>
<span class="sd">        &gt;&gt;&gt; subst[(&quot;A&quot;, &quot;A&quot;)]</span>
<span class="sd">        4</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">blosum</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">bl</span>
    <span class="n">matriz</span> <span class="o">=</span> <span class="n">bl</span><span class="o">.</span><span class="n">BLOSUM</span><span class="p">(</span><span class="mi">62</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span> <span class="n">matriz</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">matriz</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">matriz</span><span class="p">[</span><span class="n">a</span><span class="p">]}</span></div>



<div class="viewcode-block" id="matriz_substituição_dna">
<a class="viewcode-back" href="../../api.html#bioinf.alinhamento.matriz_substituição_dna">[documentos]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">matriz_substituição_dna</span><span class="p">(</span><span class="n">match</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mismatch</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cria uma matriz de substituição para DNA.</span>

<span class="sd">    Args:</span>
<span class="sd">        match (int): Pontuação para match.</span>
<span class="sd">        mismatch (int): Pontuação para mismatch.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[str, dict[str, int]]: Matriz de substituição.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; matriz_substituição_dna(2, -1)[&quot;A&quot;][&quot;C&quot;]</span>
<span class="sd">        -1</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="n">match</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span><span class="p">:</span> <span class="n">mismatch</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="n">mismatch</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">:</span> <span class="n">mismatch</span><span class="p">},</span>
        <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="n">mismatch</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span><span class="p">:</span> <span class="n">mismatch</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="n">match</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">:</span> <span class="n">mismatch</span><span class="p">},</span>
        <span class="s2">&quot;G&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="n">mismatch</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span><span class="p">:</span> <span class="n">match</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="n">mismatch</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">:</span> <span class="n">mismatch</span><span class="p">},</span>
        <span class="s2">&quot;T&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="n">mismatch</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span><span class="p">:</span> <span class="n">mismatch</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="n">mismatch</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">:</span> <span class="n">match</span><span class="p">}</span>
  <span class="p">}</span></div>



<div class="viewcode-block" id="primeira_linha_e_coluna">
<a class="viewcode-back" href="../../api.html#bioinf.alinhamento.primeira_linha_e_coluna">[documentos]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">primeira_linha_e_coluna</span><span class="p">(</span><span class="n">seq1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">seq2</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">space</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Atribui os valores à primeira linha e à primeira coluna do alinhamento global.</span>

<span class="sd">    Args:</span>
<span class="sd">        seq1 (str): Primeira sequência.</span>
<span class="sd">        seq2 (str): Segunda sequência.</span>
<span class="sd">        space (int): Penalidade de gap.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: (matriz_scores, matriz_setas)</span>
<span class="sd">            - matriz_scores: lista de listas com scores iniciais.</span>
<span class="sd">            - matriz_setas: lista de listas com setas (&quot;↑&quot;, &quot;←&quot;) na primeira linha e coluna.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; matriz, setas = primeira_linha_e_coluna(&quot;AC&quot;, &quot;GT&quot;, -2)</span>
<span class="sd">        &gt;&gt;&gt; matriz</span>
<span class="sd">        [[0, -2, -4], [-2, 0, 0], [-4, 0, 0]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">matriz</span> <span class="o">=</span> <span class="n">matriz_de_zeros</span><span class="p">(</span><span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">)</span>
    <span class="n">setas</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;&quot;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>

    <span class="k">for</span> <span class="n">p2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq2</span><span class="p">)):</span>
        <span class="n">matriz</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">p2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">matriz</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">p2</span><span class="p">]</span> <span class="o">+</span> <span class="n">space</span>
        <span class="n">setas</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">p2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;←&quot;</span>

    <span class="k">for</span> <span class="n">p1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq1</span><span class="p">)):</span>
        <span class="n">matriz</span><span class="p">[</span><span class="n">p1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">matriz</span><span class="p">[</span><span class="n">p1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">space</span>
        <span class="n">setas</span><span class="p">[</span><span class="n">p1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;↑&quot;</span>

    <span class="k">return</span> <span class="n">matriz</span><span class="p">,</span> <span class="n">setas</span></div>



<div class="viewcode-block" id="escolha_de_matriz">
<a class="viewcode-back" href="../../api.html#bioinf.alinhamento.escolha_de_matriz">[documentos]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">escolha_de_matriz</span><span class="p">(</span><span class="n">seq1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">seq2</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">match</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mismatch</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determina a matriz de substituição mais adequada (DNA ou proteína).</span>

<span class="sd">    Args:</span>
<span class="sd">        seq1 (str): Primeira sequência.</span>
<span class="sd">        seq2 (str): Segunda sequência.</span>
<span class="sd">        match (int): Pontuação para match (DNA).</span>
<span class="sd">        mismatch (int): Pontuação para mismatch (DNA).</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: Matriz de substituição adequada.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: Se os tipos das sequências forem incompatíveis.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; escolha_de_matriz(&quot;ACG&quot;, &quot;AGT&quot;, 2, -1)</span>
<span class="sd">        {&#39;A&#39;: {&#39;A&#39;: 2, &#39;G&#39;: -1, &#39;C&#39;: -1, &#39;T&#39;: -1}, ...}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">identificar_sequencia</span><span class="p">(</span><span class="n">seq1</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;DNA&quot;</span> <span class="ow">and</span> <span class="n">identificar_sequencia</span><span class="p">(</span><span class="n">seq2</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;DNA&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">matriz_substituição_dna</span><span class="p">(</span><span class="n">match</span><span class="p">,</span> <span class="n">mismatch</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">identificar_sequencia</span><span class="p">(</span><span class="n">seq1</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;AMINO&quot;</span> <span class="ow">and</span> <span class="n">identificar_sequencia</span><span class="p">(</span><span class="n">seq2</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;AMINO&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">matriz_substituição_proteína</span><span class="p">()</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Tipos de sequência incompatíveis&quot;</span><span class="p">)</span></div>



<span class="k">def</span><span class="w"> </span><span class="nf">melhor_movimento</span><span class="p">(</span><span class="n">diag</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">cima</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">esquerda</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determina o melhor movimento entre diagonal, cima ou esquerda.</span>

<span class="sd">    Args:</span>
<span class="sd">        diag (int): Score da diagonal.</span>
<span class="sd">        cima (int): Score de cima.</span>
<span class="sd">        esquerda (int): Score da esquerda.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[int, str]: Melhor score e seta correspondente (&quot;↖&quot;, &quot;↑&quot;, &quot;←&quot;).</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; melhor_movimento(3, 2, 1)</span>
<span class="sd">        (3, &#39;↖&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">melhor</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">diag</span><span class="p">,</span> <span class="n">cima</span><span class="p">,</span> <span class="n">esquerda</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">melhor</span> <span class="o">==</span> <span class="n">diag</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">melhor</span><span class="p">,</span> <span class="s2">&quot;↖&quot;</span>
    <span class="k">if</span> <span class="n">melhor</span> <span class="o">==</span> <span class="n">cima</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">melhor</span><span class="p">,</span> <span class="s2">&quot;↑&quot;</span>
    <span class="k">return</span> <span class="n">melhor</span><span class="p">,</span> <span class="s2">&quot;←&quot;</span>


<div class="viewcode-block" id="montar_grid">
<a class="viewcode-back" href="../../api.html#bioinf.alinhamento.montar_grid">[documentos]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">montar_grid</span><span class="p">(</span><span class="n">matriz</span><span class="p">,</span> <span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Monta um grid de scores com a primeira linha e coluna mostrando as sequências.</span>

<span class="sd">    Args:</span>
<span class="sd">        matriz (list[list[int]]): Matriz de scores (inicial ou calculada).</span>
<span class="sd">        seq1 (str): Primeira sequência (linha).</span>
<span class="sd">        seq2 (str): Segunda sequência (coluna).</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[list[str|int]]: Grid de scores com seq2 na primeira linha e seq1 na primeira coluna.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; matriz = [[0, -2, -4], [-2, 0, 0], [-4, 0, 0]]</span>
<span class="sd">        &gt;&gt;&gt; montar_grid(matriz, &quot;AC&quot;, &quot;GT&quot;)</span>
<span class="sd">        [[&#39; &#39;, &#39;G&#39;, &#39;T&#39;], [&#39;A&#39;, -2, -4], [&#39;C&#39;, 0, 0]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot; &quot;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">seq2</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">seq1</span><span class="p">):</span>
        <span class="n">linha</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">+</span> <span class="n">matriz</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">grid</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">linha</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">grid</span></div>



<div class="viewcode-block" id="imprimir_grid">
<a class="viewcode-back" href="../../api.html#bioinf.alinhamento.imprimir_grid">[documentos]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">imprimir_grid</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">setas</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Imprime o grid de scores e a matriz de setas de forma legível.</span>

<span class="sd">    Args:</span>
<span class="sd">        grid (list[list[str|int]]): Grid de scores com seq2 na primeira linha e seq1 na primeira coluna.</span>
<span class="sd">        setas (list[list[str]]): Matriz de setas (&quot;↖&quot;, &quot;↑&quot;, &quot;←&quot;, &quot;STOP&quot;) correspondente ao grid.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; grid = montar_grid(matriz, &quot;AC&quot;, &quot;GT&quot;)</span>
<span class="sd">        &gt;&gt;&gt; imprimir_grid(grid, setas)</span>
<span class="sd">        Matriz de Scores:</span>
<span class="sd">        [&#39; &#39;, &#39;G&#39;, &#39;T&#39;]</span>
<span class="sd">        [&#39;A&#39;, -2, -4]</span>
<span class="sd">        [&#39;C&#39;, 0, 0]</span>

<span class="sd">        Matriz de Setas:</span>
<span class="sd">        [&#39;&#39;, &#39;←&#39;, &#39;←&#39;]</span>
<span class="sd">        [&#39;↑&#39;, &#39;↖&#39;, &#39;↖&#39;]</span>
<span class="sd">        [&#39;↑&#39;, &#39;↑&#39;, &#39;↖&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Matriz de Scores:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">linha</span> <span class="ow">in</span> <span class="n">grid</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">linha</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Matriz de Setas:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">linha</span> <span class="ow">in</span> <span class="n">setas</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">linha</span><span class="p">)</span></div>



<div class="viewcode-block" id="needleman_wunsch">
<a class="viewcode-back" href="../../api.html#bioinf.alinhamento.needleman_wunsch">[documentos]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">needleman_wunsch</span><span class="p">(</span><span class="n">seq1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">seq2</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">match</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">mismatch</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="n">space</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Realiza um alinhamento global usando o algoritmo Needleman-Wunsch.</span>

<span class="sd">    Imprime a matriz de scores e a matriz de setas em formato legível (grid).</span>

<span class="sd">    Args:</span>
<span class="sd">        seq1 (str): Primeira sequência.</span>
<span class="sd">        seq2 (str): Segunda sequência.</span>
<span class="sd">        match (int, optional): Pontuação para match. Default é 2.</span>
<span class="sd">        mismatch (int, optional): Pontuação para mismatch. Default é -3.</span>
<span class="sd">        space (int, optional): Penalidade de gap. Default é -4.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[list[list[str|int]], list[list[str]]]:</span>
<span class="sd">            - grid_scores: Matriz de scores com a primeira linha e coluna mostrando seq2 e seq1.</span>
<span class="sd">            - setas: Matriz de setas (&quot;↖&quot;, &quot;↑&quot;, &quot;←&quot;) indicando o caminho do alinhamento.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; grid, setas = needleman_wunsch(&quot;ACG&quot;, &quot;AG&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">matriz</span><span class="p">,</span> <span class="n">setas</span> <span class="o">=</span> <span class="n">primeira_linha_e_coluna</span><span class="p">(</span><span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">,</span> <span class="n">space</span><span class="p">)</span>
    <span class="n">subst</span> <span class="o">=</span> <span class="n">escolha_de_matriz</span><span class="p">(</span><span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">,</span> <span class="n">match</span><span class="p">,</span> <span class="n">mismatch</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">seq1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">seq2</span><span class="p">):</span>
            <span class="n">diag</span> <span class="o">=</span> <span class="n">matriz</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">subst</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">subst</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
            <span class="n">cima</span> <span class="o">=</span> <span class="n">matriz</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">space</span>
            <span class="n">esquerda</span> <span class="o">=</span> <span class="n">matriz</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">space</span>
            <span class="n">score</span><span class="p">,</span> <span class="n">seta</span> <span class="o">=</span> <span class="n">melhor_movimento</span><span class="p">(</span><span class="n">diag</span><span class="p">,</span> <span class="n">cima</span><span class="p">,</span> <span class="n">esquerda</span><span class="p">)</span>
            <span class="n">matriz</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">score</span>
            <span class="n">setas</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">seta</span>

    <span class="n">grid</span> <span class="o">=</span> <span class="n">montar_grid</span><span class="p">(</span><span class="n">matriz</span><span class="p">,</span> <span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">)</span>
    <span class="n">imprimir_grid</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">setas</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">grid</span><span class="p">,</span><span class="n">setas</span></div>



<div class="viewcode-block" id="smith_waterman">
<a class="viewcode-back" href="../../api.html#bioinf.alinhamento.smith_waterman">[documentos]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">smith_waterman</span><span class="p">(</span><span class="n">seq1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">seq2</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">match</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">mismatch</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="n">space</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Realiza um alinhamento local usando o algoritmo Smith-Waterman.</span>

<span class="sd">    Imprime a matriz de scores e a matriz de setas em formato legível (grid).</span>

<span class="sd">    Args:</span>
<span class="sd">        seq1 (str): Primeira sequência.</span>
<span class="sd">        seq2 (str): Segunda sequência.</span>
<span class="sd">        match (int, optional): Pontuação para match. Default é 2.</span>
<span class="sd">        mismatch (int, optional): Pontuação para mismatch. Default é -3.</span>
<span class="sd">        space (int, optional): Penalidade de gap. Default é -4.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[list[list[str|int]], list[list[str]]]:</span>
<span class="sd">            - grid_scores: Matriz de scores com a primeira linha e coluna mostrando seq2 e seq1.</span>
<span class="sd">            - setas: Matriz de setas (&quot;↖&quot;, &quot;↑&quot;, &quot;←&quot;, &quot;STOP&quot;) indicando o caminho do alinhamento.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; grid, setas = smith_waterman(&quot;ACG&quot;, &quot;AG&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">matriz</span> <span class="o">=</span> <span class="n">matriz_de_zeros</span><span class="p">(</span><span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">)</span>
    <span class="n">setas</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;&quot;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
    <span class="n">subst</span> <span class="o">=</span> <span class="n">escolha_de_matriz</span><span class="p">(</span><span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">,</span> <span class="n">match</span><span class="p">,</span> <span class="n">mismatch</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">seq1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">seq2</span><span class="p">):</span>
            <span class="n">diag</span> <span class="o">=</span> <span class="n">matriz</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">subst</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">subst</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
            <span class="n">cima</span> <span class="o">=</span> <span class="n">matriz</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">space</span>
            <span class="n">esquerda</span> <span class="o">=</span> <span class="n">matriz</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">space</span>
            <span class="n">melhor_score</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">diag</span><span class="p">,</span> <span class="n">cima</span><span class="p">,</span> <span class="n">esquerda</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">melhor_score</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">setas</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;STOP&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">setas</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;↖&quot;</span> <span class="k">if</span> <span class="n">melhor_score</span> <span class="o">==</span> <span class="n">diag</span> <span class="k">else</span> <span class="s2">&quot;↑&quot;</span> <span class="k">if</span> <span class="n">melhor_score</span> <span class="o">==</span> <span class="n">cima</span> <span class="k">else</span> <span class="s2">&quot;←&quot;</span>

            <span class="n">matriz</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">melhor_score</span>

    <span class="n">grid</span> <span class="o">=</span> <span class="n">montar_grid</span><span class="p">(</span><span class="n">matriz</span><span class="p">,</span> <span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">)</span>
    <span class="n">imprimir_grid</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">setas</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">grid</span><span class="p">,</span><span class="n">setas</span></div>



<div class="viewcode-block" id="reconstruir_alinhamento">
<a class="viewcode-back" href="../../api.html#bioinf.alinhamento.reconstruir_alinhamento">[documentos]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">reconstruir_alinhamento</span><span class="p">(</span><span class="n">setas</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">seq1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">seq2</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reconstrói o alinhamento final a partir da matriz de setas.</span>

<span class="sd">    Funciona tanto para Needleman-Wunsch quanto para Smith-Waterman.</span>
<span class="sd">    Para Smith-Waterman, o caminho termina ao encontrar &quot;STOP&quot;.</span>

<span class="sd">    Args:</span>
<span class="sd">        setas (list[list[str]]): Matriz de setas (&quot;↖&quot;, &quot;↑&quot;, &quot;←&quot;, &quot;STOP&quot;).</span>
<span class="sd">        seq1 (str): Primeira sequência.</span>
<span class="sd">        seq2 (str): Segunda sequência.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[str, str]: Sequências alinhadas.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; grid, setas = needleman_wunsch(&quot;ACG&quot;, &quot;AG&quot;)</span>
<span class="sd">        &gt;&gt;&gt; reconstruir_alinhamento(setas, &quot;ACG&quot;, &quot;AG&quot;)</span>
<span class="sd">        (&#39;ACG&#39;, &#39;A-G&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq2</span><span class="p">)</span>
    <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">direcao</span> <span class="o">=</span> <span class="n">setas</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">direcao</span> <span class="o">==</span> <span class="s2">&quot;STOP&quot;</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">elif</span> <span class="n">direcao</span> <span class="o">==</span> <span class="s2">&quot;↖&quot;</span><span class="p">:</span>
            <span class="n">a1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">seq1</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
            <span class="n">a2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">seq2</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
            <span class="n">i</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">j</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">direcao</span> <span class="o">==</span> <span class="s2">&quot;↑&quot;</span><span class="p">:</span>
            <span class="n">a1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">seq1</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
            <span class="n">a2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">direcao</span> <span class="o">==</span> <span class="s2">&quot;←&quot;</span><span class="p">:</span>
            <span class="n">a1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
            <span class="n">a2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">seq2</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
            <span class="n">j</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">a1</span><span class="p">)),</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">a2</span><span class="p">))</span></div>



<span class="c1">#Alinhamento progressivo (múltiplo):</span>
<span class="c1"># consenso + alinhamento</span>

<div class="viewcode-block" id="consenso">
<a class="viewcode-back" href="../../api.html#bioinf.alinhamento.consenso">[documentos]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">consenso</span><span class="p">(</span><span class="n">alinhamento</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calcula a sequência consenso de um alinhamento múltiplo.</span>

<span class="sd">    Args:</span>
<span class="sd">        alinhamento (list[str]): Lista de sequências alinhadas.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Sequência consenso.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; consenso([&quot;ACG&quot;, &quot;A-G&quot;, &quot;ACG&quot;])</span>
<span class="sd">        &#39;ACG&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">seq_consenso</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">coluna</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">alinhamento</span><span class="p">):</span>
        <span class="n">bases</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">simbolo</span> <span class="ow">in</span> <span class="n">coluna</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">simbolo</span> <span class="o">!=</span> <span class="s2">&quot;-&quot;</span><span class="p">:</span>
                <span class="n">bases</span><span class="p">[</span><span class="n">simbolo</span><span class="p">]</span> <span class="o">=</span> <span class="n">bases</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">simbolo</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">seq_consenso</span> <span class="o">+=</span> <span class="nb">max</span><span class="p">(</span><span class="n">bases</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">bases</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">seq_consenso</span></div>



<div class="viewcode-block" id="melhor_movimento">
<a class="viewcode-back" href="../../api.html#bioinf.alinhamento.melhor_movimento">[documentos]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">melhor_movimento</span><span class="p">(</span><span class="n">diag</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">cima</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">esquerda</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determina o melhor movimento entre diagonal, cima ou esquerda.</span>

<span class="sd">    Args:</span>
<span class="sd">        diag (int): Score da diagonal.</span>
<span class="sd">        cima (int): Score de cima.</span>
<span class="sd">        esquerda (int): Score da esquerda.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[int, str]: Melhor score e seta correspondente (&quot;↖&quot;, &quot;↑&quot;, &quot;←&quot;).</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; melhor_movimento(3, 2, 1)</span>
<span class="sd">        (3, &#39;↖&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">melhor</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">diag</span><span class="p">,</span> <span class="n">cima</span><span class="p">,</span> <span class="n">esquerda</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">melhor</span> <span class="o">==</span> <span class="n">diag</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">melhor</span><span class="p">,</span> <span class="s2">&quot;↖&quot;</span>
    <span class="k">if</span> <span class="n">melhor</span> <span class="o">==</span> <span class="n">cima</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">melhor</span><span class="p">,</span> <span class="s2">&quot;↑&quot;</span>
    <span class="k">return</span> <span class="n">melhor</span><span class="p">,</span> <span class="s2">&quot;←&quot;</span></div>



<div class="viewcode-block" id="alinhar_par">
<a class="viewcode-back" href="../../api.html#bioinf.alinhamento.alinhar_par">[documentos]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">alinhar_par</span><span class="p">(</span><span class="n">seq1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">seq2</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subst</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">space</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Realiza um alinhamento simples entre duas sequências.</span>

<span class="sd">    Args:</span>
<span class="sd">        seq1 (str): Primeira sequência.</span>
<span class="sd">        seq2 (str): Segunda sequência.</span>
<span class="sd">        subst (dict): Matriz de substituição.</span>
<span class="sd">        space (int): Penalidade de gap.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[str, str]: Sequências alinhadas.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; subst = matriz_substituição_dna(2, -1)</span>
<span class="sd">        &gt;&gt;&gt; alinhar_par(&quot;ACG&quot;, &quot;AG&quot;, subst, -2)</span>
<span class="sd">        (&#39;ACG&#39;, &#39;A-G&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">matriz</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
    <span class="n">setas</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;&quot;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq1</span><span class="p">)):</span>
        <span class="n">matriz</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">matriz</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">space</span>
        <span class="n">setas</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;↑&quot;</span>

    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq2</span><span class="p">)):</span>
        <span class="n">matriz</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">matriz</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">space</span>
        <span class="n">setas</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;←&quot;</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">seq1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">seq2</span><span class="p">):</span>
            <span class="n">diag</span> <span class="o">=</span> <span class="n">matriz</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">subst</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span>
            <span class="n">cima</span> <span class="o">=</span> <span class="n">matriz</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">space</span>
            <span class="n">esquerda</span> <span class="o">=</span> <span class="n">matriz</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">space</span>

            <span class="n">valor</span><span class="p">,</span> <span class="n">seta</span> <span class="o">=</span> <span class="n">melhor_movimento</span><span class="p">(</span><span class="n">diag</span><span class="p">,</span> <span class="n">cima</span><span class="p">,</span> <span class="n">esquerda</span><span class="p">)</span>
            <span class="n">matriz</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">valor</span>
            <span class="n">setas</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">seta</span>

    <span class="k">return</span> <span class="n">reconstruir_alinhamento</span><span class="p">(</span><span class="n">setas</span><span class="p">,</span> <span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">)</span></div>



<div class="viewcode-block" id="alinhar_consenso">
<a class="viewcode-back" href="../../api.html#bioinf.alinhamento.alinhar_consenso">[documentos]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">alinhar_consenso</span><span class="p">(</span><span class="n">alinhamento</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">nova_seq</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subst</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">space</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Alinha uma nova sequência ao consenso existente.</span>

<span class="sd">    Args:</span>
<span class="sd">        alinhamento (list[str]): Lista de sequências alinhadas.</span>
<span class="sd">        nova_seq (str): Nova sequência a ser alinhada.</span>
<span class="sd">        subst (dict): Matriz de substituição.</span>
<span class="sd">        space (int): Penalidade de gap.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[str]: Novo alinhamento múltiplo.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; subst = matriz_substituição_dna(2, -1)</span>
<span class="sd">        &gt;&gt;&gt; alinhar_consenso([&quot;ACG&quot;, &quot;A-C&quot;], &quot;AG&quot;, subst, -2)</span>
<span class="sd">        [&#39;ACG&#39;, &#39;A-C&#39;, &#39;A-G&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cons</span> <span class="o">=</span> <span class="n">consenso</span><span class="p">(</span><span class="n">alinhamento</span><span class="p">)</span>
    <span class="n">cons_al</span><span class="p">,</span> <span class="n">nova_al</span> <span class="o">=</span> <span class="n">alinhar_par</span><span class="p">(</span><span class="n">cons</span><span class="p">,</span> <span class="n">nova_seq</span><span class="p">,</span> <span class="n">subst</span><span class="p">,</span> <span class="n">space</span><span class="p">)</span>

    <span class="n">novo_alinhamento</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">simbolo</span> <span class="ow">in</span> <span class="n">cons_al</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">simbolo</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span><span class="p">:</span>
            <span class="n">novo_alinhamento</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">alinhamento</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">novo_alinhamento</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">seq</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="n">alinhamento</span><span class="p">))</span>
            <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">alinhamento_final</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">coluna</span><span class="p">)</span> <span class="k">for</span> <span class="n">coluna</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">novo_alinhamento</span><span class="p">)]</span>
    <span class="n">alinhamento_final</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nova_al</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">alinhamento_final</span></div>



<div class="viewcode-block" id="alinhamento_progressivo">
<a class="viewcode-back" href="../../api.html#bioinf.alinhamento.alinhamento_progressivo">[documentos]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">alinhamento_progressivo</span><span class="p">(</span><span class="n">seqs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">subst</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">space</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Realiza um alinhamento múltiplo progressivo de sequências.</span>

<span class="sd">    Args:</span>
<span class="sd">        seqs (list[str]): Lista de sequências.</span>
<span class="sd">        subst (dict): Matriz de substituição.</span>
<span class="sd">        space (int, optional): Penalidade de gap. Default é -4.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[str]: Lista de sequências alinhadas.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; seqs = [&quot;ACG&quot;, &quot;AC&quot;, &quot;AG&quot;]</span>
<span class="sd">        &gt;&gt;&gt; subst = matriz_substituição_dna(2, -1)</span>
<span class="sd">        &gt;&gt;&gt; alinhamento_progressivo(seqs, subst)</span>
<span class="sd">        [&#39;ACG&#39;, &#39;A-C&#39;, &#39;A-G&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">alinhamento</span> <span class="o">=</span> <span class="p">[</span><span class="n">seqs</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="n">seqs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="n">alinhamento</span> <span class="o">=</span> <span class="n">alinhar_consenso</span><span class="p">(</span><span class="n">alinhamento</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">subst</span><span class="p">,</span> <span class="n">space</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">alinhamento</span></div>

</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">portefolio_AASB</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Ir" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navegação</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Código do módulo</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2026, grupo_8.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 9.1.0</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
    </div>

    

    
  </body>
</html>